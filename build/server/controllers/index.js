// Generated by CoffeeScript 1.7.1
var Mailbox, async;

async = require('async');

Mailbox = require('../models/mailbox');

module.exports.main = function(req, res, next) {
  return async.parallel([
    function(cb) {
      return Mailbox.getAll(cb);
    }
  ], function(err, results) {
    var mailboxes;
    if (err != null) {
      return res.render('index.jade', {
        imports: ""
      });
    } else {
      mailboxes = results[0];
      return res.render('index.jade', {
        imports: "window.mailboxes = " + (JSON.stringify(mailboxes)) + ";"
      });
    }
  });
};
