// Generated by CoffeeScript 1.7.1
var Contact, contacts;

contacts = [
  {
    name: "Claude Lambda",
    address: "claude.lambda@free.fr"
  }, {
    name: "Alex Lambda",
    address: "alex.lambda@free.fr"
  }, {
    name: "Dominique Lambda",
    address: "dominique.lambda@free.fr"
  }, {
    name: "Camille Guique",
    address: "camille@guique.net"
  }, {
    name: "Alix Guique",
    address: "alix@guique.net"
  }, {
    name: "Dany Guique",
    address: "dany@guique.net"
  }, {
    name: "Gwen Guique",
    address: "gwen@guique.net"
  }
];

Contact = {
  search: function(data) {
    var re, res;
    if (data.query != null) {
      re = new RegExp(data.query, 'gi');
      res = contacts.filter(function(contact) {
        return re.test(contact.name + contact.address);
      });
      return res;
    } else {
      return contacts;
    }
  },
  create: function(data) {
    contacts.push(data.contact);
    return null;
  }
};

module.exports.create = function(req, res, next) {
  var activity;
  activity = req.body;
  switch (activity.data.type) {
    case 'contact':
      if (Contact[activity.name] != null) {
        return res.send(201, {
          result: Contact[activity.name](activity.data)
        });
      } else {
        return res.send(400, {
          name: "Unknown activity name",
          error: true
        });
      }
      break;
    default:
      return res.send(400, {
        name: "Unknown activity data type",
        error: true
      });
  }
};
